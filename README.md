# IoT Traffic Control

# **EA Traffic Control â€” Project Overview (For IoT Team)**

---

## ğŸ¯ **Conceptual Overview**

This project develops an **AI-driven adaptive traffic light controller** that updates timing **every cycle** using real-time data.

The system works in **two stages**:

### **1ï¸âƒ£ Differential Evolution (DE) â€” The â€œTeacherâ€**

DE is a **population-based optimization algorithm** that works like a team of problem solvers exploring different solutions.

Think of it like this:

- DE starts with many random timing plans (different values of split `s` and cycle length `C`).
- Each plan is tested in a simulation.
- The best-performing plans are combined and mutated to create even better plans.
- After many iterations, DE finds a **high-quality traffic-signal timing plan** for the given traffic condition.

Conceptually:

```
Try many timing plans â†’ keep the best â†’ mix/mutate â†’ repeat â†’ get optimal plan
```

DE is **accurate** but **slow**, taking 10â€“30 seconds per cycle.

### **2ï¸âƒ£ MLP Neural Network â€” The â€œStudentâ€**

To achieve real-time control:

- An **MLP model is trained to learn from DEâ€™s optimal decisions**
- The MLP predicts `(s, C)` in **milliseconds**, perfect for IoT devices

So the pipeline is:

```
DE finds optimal solutions â†’ MLP learns them â†’ MLP runs in real-time
```

This is the core innovation of the project:

**Use DE offline to generate intelligence â†’ compress it into an MLP for fast online control.**

---

# **ğŸ›‘ Key Traffic-Signal Parameters**

Each signal cycle is defined by two variables:

- **Green split (s)** â€” how long NS vs EW gets green
- **Cycle length (C)** â€” duration of one full cycle

The controller outputs:

```
(s, C) for the next cycle
```

---

# **ğŸ“Š Optimization Objectives (DE)**

DE evaluates each timing plan using:

- **Oâ‚ â€” Reduce average delay**
- **Oâ‚‚ â€” Fairness between directions**

Final score:

```
score = w1 * O1 + w2 * O2
```

DE improves timing plans until finding the near-best timing.

---

# **ğŸ§  Why We Need the MLP**

- DE = **accurate but slow**
- MLP = **slightly less accurate but extremely fast**

In real IoT systems, we need decisions **within milliseconds**, not seconds.

Therefore:

- **DE = offline computation**
- **MLP = online real-time controller**

---

# **ğŸš¦ End-to-End System Pipeline (IoT Perspective)**

```
Sensors (loops / cameras)
        â”‚
        â–¼
Extract traffic features (queues, delay, EMA)
        â”‚
        â–¼
MLP Controller (edge device)
â†’ Predict (s, C) for next cycle
        â”‚
        â–¼
Traffic Light Controller applies the plan
        â”‚
        â–¼
(Optional) log data for retraining
```

---

# **ğŸ§ª Repository Pipeline (How the Code Works)**

---

## **1. Scenario Setup**

- SUMO network
- Initial state configuration via `src/config.py`

---

## **2. Generate DE Data**

Use DE to produce labeled samples:

```
features â†’ DE-optimal (s, C)
```

Generated by:

- `src.de_experiment.seed_de_teacher_simulation`

Stored in:

- `datasets/`
- `logs/`

---

## **3. Build Teacher Dataset**

Collected into CSVs containing:

- traffic features
- optimal split & cycle length

Used for training the MLP.

---

## **4. Train the MLP**

Using either:

- `src/train_de_mlp.train_de_ml`
- `mlp_training.ipynb`

Outputs:

- trained model (`.pth`)
- normalization scalers
- plots and logs

---

## **5. Deploy MLP on Edge Device**

Export model to:

- **TorchScript**
- **ONNX Runtime**

Edge flow:

```
sensor features â†’ scaler â†’ MLP â†’ enforce bounds â†’ send to controller
```

---

# **ğŸ“ Important Repository Components**

---

## **Notebooks**

- `controller.ipynb` â€” DE-based control
- `mlp_training.ipynb` â€” train the MLP
- `mlp_controller.ipynb` â€” test MLP predictions

---

## **Core Python Files**

- `src/de_experiment.py`
- `src/train_de_mlp.py`
- `src/config.py`

---

## **Data & Models**

- `datasets/` â€” DE teacher data
- `models/` â€” trained MLP model
- `logs/` â€” simulation results

---

# **ğŸ§© Why This Is an IoT Project**

The teammates only need these concepts:

### **IoT Flow**

```
Sensors â†’ Edge inference â†’ Actuator â†’ Cloud
```

### **Real-Time Requirement**

- MLP must respond **under 100 ms**
- DE is too slow for deployment

### **Edge-ready Design**

- Model exported to ONNX/TorchScript
- Runs on Pi, Jetson, Coral TPU, etc.

---

# **ğŸ›Ÿ Safety & Fallback Strategy**

System enforces:

- valid split range
- valid cycle length range

If the model misbehaves:

- Use baseline fixed timing
- trigger safety fallback

---

# **ğŸ—‚ Role Breakdown**

---

## **Documentation Team**

- Explain the DE conceptually
- Explain why MLP speeds things up
- Draw pipeline diagrams

---

## **Presentation Team**

- Show before/after traffic improvements
- Show system architecture
- Show MLP latency comparison vs DE

---

## **Demo Team**

- Run SUMO notebook
- Show MLP ONNX inference
- Display logs/graphs

---

# **âœ”ï¸ Summary**

This system integrates:

- **Optimization (DE)**
- **Machine learning (MLP)**
- **Edge computing (IoT)**

Final result: a **fast, adaptive, smart traffic-light controller** that updates every cycle based on live traffic.

[IoT Traffic Control Tá»•ng quan](https://www.notion.so/IoT-Traffic-Control-T-ng-quan-2c50d751aef1801a8fd9d36da2732577?pvs=21)